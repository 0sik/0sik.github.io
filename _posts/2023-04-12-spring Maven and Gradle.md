---
layout: single
title: "Maven and Gradle"
toc: true
toc_sticky: true
toc_label: "목차"
categories: spring
toc_icon: "bars"
tags: [spring]
---

📘 Maven and Gradle

# Maven 소개
- 프로젝트를 관리하는 도구
- 빌드 자동화 기능과 프로젝트 관리 기능을 제공
    - 프로젝트(라이브러리) 관리 : porm.xml파일을 이용하여 프로젝트 관련된 jar파일을 다운로드 하고 관리, 프로젝트 산출물을 일관도니 구조로 관리
    - 빌드 자동화 : 빌드 작업들을 관리하고 쉽게 그리고 일관성 있게 수행할 수 있는 통합 환경을 제공, 빌드는 소스 코드 파일을 실행 코드로 변환하여 배포하는 과정

# 프로젝트 관리 기능
- 일반 개발자 프로젝트 관리 설정들을 메이븐이 미리 정의한 설정들로 대체한다.
- 정형화된 프로젝트 디렉토리 구조 관리(porm.xml)
- 의존성 관리 기능 : 편리한 라이브러리 관리 기능 
- 빌드 프로셋스를 관리 : 플러그인 설정을 통한 빌드 자동화

## 의존 관계(라이브러리)설정 (porm.xml)
- 프로젝트 당 한 개의 porm.xml파일 관리
    - 모든 POM은 Super Pom(기본 POM)으로부터 상속받는다
        - Super POM은 기본 설정 정보를 포함한다
        - Super POM을 수정하려면 POM에서 오바라이드 한다.
- 최상위 엘리먼트 : project
- 3개의 필수 필드를 가짐
    - groupid : 프로젝트 조직 고유 도메인
    - artifactid : 프로젝트 명
    - version : 프로젝트 버전
- 프로젝트 의존관계의 라이브러리 관리 : dependecy

## 빌드 설정
- 프로젝트 기본 정보, 저장소,프로퍼티,디렉토리 구조
- 플러그인
- 골

## Maven Repositroy
- 메이븐 저장소는 프로젝트에 사용되는 프로젝트 jar 파일, 라이브러리 jar파일들이 위치하며 3가지 타입이 있다. 
1. 지역(local)저장소 : 로컬 저장소는 메이븐을 빌드할 때 다운로드하는 라이브러리, 플러그인을 관리하는 저장소 이다. 
2. 중앙 저장소 : 오픈 소스 라이브러리, 메이븐 플러그인 , 메이븐 아키타입을 관리하는 저장소이다.
3. 원격 저장소 : 메이븐 기반으로 프로젝트를 진행하는 경우 프로젝트에 필요한 모든 라이브러리가 메이븐 중앙 저장소에 존재하는것이 아니다. 이처럼 중앙 저장소에 존재하지 않는 라이브러리를 관리하기 위하여 별도의 메이븐 저장소를 설치해 관리하는것이 가능하다.

### 메이븐 의존성 검색 절차
1단계 : 지역 저장소를 검색한다. 찾는 라이브러리가 없을 경우 2단계로 넘어간다
2단계 : 중앙 저장소를 검색한다. 찾는 라이브러리는 지역 저장소에 저장한다. 만약 찾는라이브러리가 없을경우 3단계로 넘어간다. 만약 원격 저장소가 존재하지 않을 경우 에러를 발생시키고 종료한다
3단계 : 원격저장소를 검색한다. 찾은 라이브러리는 지역 저장소에 저장한다. 만약 찾는 라이브러리가 없을 경우 에러를 발생시키고 종료한다.

# 빌드 자동화 기능
- 메이븐은 소프트웨어 빌드를 위한 공통 인터페이스를 제공하는 프레임 워크 
    - 플러그인 설정을 통해 기능을 위임
- 빌드 단계(컴파일,테스트,패키징,배포)들을 빌드 라이프 사이클이라고한다.
- 각 빌드 단계에서 수행되는 작업을 골 이라고한다
- 실제 골은 그 단계에 연결된 플러그인에 의해 실행된다.

## Maven 빌드 라이프 사이클
- 라이프 사이클은 미리 정해진 빌드 순서를 의미한다.
- Maven은 build,clean,site3개의 라이프사이클이 있다.
- build 라이프 사이클은 여러 단계의 페이즈로 나뉘어져 있으며, 각 페이즈는 의존관계를 가진다, compile,test,package,deploy순서로 진행된다
- clean라이프사이클은 clean페이즈를 이용하여 이전 빌드에서 생성된 모든 파일들을 삭제한다
- site라이프 사이클은 site,site-deploy페이즈를 이용하여 생성된 문서들을 대상 사이트에 배포한다.

### 일부 단계
리소스 준비 : 리소스가 준비되어 복사된다.
컴파일 : 소스코드를 컴파일한다.
테스트 : junit과 같은 테스트 프레임워크로 단위 테스트한다
패키지 : porm.xml의 엘리먼트값(jar,war,ear)등에 따라 압축한다
인스톨 : 패키지를 로컬 저장소에 배포한다
배포 : 원격 메이븐 저장소에 압축한 파일을 배포한다.

### Maven Phase & Goal
- 빌드 라이프사이클은 하나 이상의 골을수행하는 페이지들로 구성
- 각 페이즈 별로 플러그인이 작업을 수행한다. 이 작업을 Goal이라고 한다.

### Maven Plugin
- 대부분의 기능들을 플로그인을 통해서 제공된다
- clean : 빌드 이후에 target디렉토리를 삭제한다
- compiler : 자바 소스 파일을 컴파일한다.
- surefile : junit 단위 테스트를 실행한다. 리포트를 생성한다
- jar : 현재 프로젝트로부터 jar file를 생성한다
- war : 현재 프로젝트로부터 warfile를 생성한다
- javadoc : 프로젝트의 javadoc문서를 생성한다
- antrun : 빌드 페이지 단계에서 특정 ant 작업을 실행한다.

# Gradle개요
- JVM에서 실행
- Maven처럼 Convention(규범)을 통해 프로젝트 생성과 빌드 수행
- Maven처럼 저장소 관리 기능 제공
- 다양한 플러그 인 제공
- 빌드 설정 스크립트를 Grovy기반의 DSL사용
- Gradle 설치 없이 Gradle Wrapper를 이용하여 빌드 지원
- 멀티 프로젝트 구성  가능 : 하나의 repository내에 여러 개의 하위 프로젝트를 구성

## 구조
gradle-wrapper.jar : gradel task를 실행하기 위한 Wrapper파일 . Wrapper는 선언된 버전의 gradle을 호출하여 필요한 경우 미리 다운로드 . 프로젝트를 새로운 환경에 종속되지 않고 빌드 가능
gradle-wrapper.properties : gradle wrapper 설정 정보 파일
build.gradle : 프로젝트의 라이브러리 의존성, 플러그인, 라이브러리 저장소 등을 설정
할 수 있는 빌드 스크립트 파일
Gradlew : 리눅스 또는 맥OS용 실행 스크립트 파일
gradlew.bat : 윈도우용 실행 스크립트 파일
setting.gradle : 프로젝트의 설정 정보 파일

## build.gradle 설정
- plugin : 작업 수행 환경을 명시
- Version 및 Group : 패키지 상의 적용 범위와 어플리케이션 버전 , java버전을 명시
- profile : 개발 환경에 따른 profile환경 파일
- buildscript : 앞서 선언한 플러그인의 의존성을 관리
- dependencies(library) : 기본적인 플러그인 이외 개발에 필요한 추가 라이브러리 의존성 관리