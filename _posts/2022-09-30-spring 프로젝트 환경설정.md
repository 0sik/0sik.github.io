---
layout: single
title: "í”„ë¡œì íŠ¸ í™˜ê²½ì„¤ì •"
toc: true
toc_sticky: true
toc_label: "ëª©ì°¨"
toc_icon: "bars"
categories: spring
tags: [spring]
---

ğŸ“˜ìŠ¤í”„ë§ë¶€íŠ¸


# í”„ë¡œì íŠ¸ ìƒì„±
ìŠ¤í”„ë§ ë¶€íŠ¸ ìŠ¤íƒ€í„°([https://start.spring.io/](https://start.spring.io/))
Maven Project(ìë°”ìš© í”„ë¡œì íŠ¸ ê´€ë¦¬ ë„êµ¬) Gradle Project(ë¹Œë“œ ìë™í™” ì‹œìŠ¤í…œ)
ìš”ì¦˜ì€ Gradleì„ ë§ì´ ì”€
> Dependencies(ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì •)
1 . Spring web (RESTful apië‚˜ Spring MVC, Apache Torncatì„ ì“¸ìˆ˜ìˆìŒ)
2 . Thymeleaf(JSP(ìš”ì¦˜ì•ˆì”€)ë¥¼ ì“¸ê²Œ ì•„ë‹ˆì—¬ì„œ Thymeleafë¥¼ ì”€ , modern server-side java template(í…œí”Œë¦¿)) (https://www.thymeleaf.org/)
3 . Spring Data JPA( Java persistence Api)
4 . H2 Database(ë°ì´í„°ë² ì´ìŠ¤)
5 . Lombok(ì§€ë£¨í•˜ê²Œ ë°˜ë³µí•˜ëŠ” ì½”ë“œë¥¼ ì¤„ì—¬ì¤Œ)(Lombokì„ ì“°ë ¤ë©´ pluginsì—ì„œ ì„¤ì¹˜í›„ Build,Execution,Deployment->Compiler->Annotation Processorsì—ì„œ Enable annotation processingí™œì„±í™”

generateë¡œ í´ë” ë‹¤ìš´ë°›ê³  ìê¸°ê°€ ì›í•˜ëŠ” ìœ„ì¹˜ì— ì••ì¶œí’€ê¸°,IDEAë¡œ íŒŒì¼ì—´ê¸°

# View í™˜ê²½ ì„¤ì •
```
@Controller
public class HeoolController {
    @GetMapping("hello")
    public String hello(Model model){
        model.addAttribute("data","hello");
        return "hello";
    }
}
```
@GetMapping("~~") =>  ~~ì´ë¼ëŠ” urlì£¼ì†Œë¡œ ì˜¤ë©´ ë°‘ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í˜¸ì¶œ
Model model => spring uiì— ìˆëŠ” modelì— ë°ì´í„°ë¥¼ ì‹¤ì–´ì„œ viewë¡œ ë„˜ê¸¸ìˆ˜ ìˆë‹¤.
model.addAtrribute("data","hello"); => dataë¼ëŠ” í‚¤ì— ê°’ì˜ helloë¼ëŠ” ê°’ì„ ë„˜ê¸´ë‹¤
return "hello" => hello.htmlì´ ìë™ìœ¼ë¡œ ë¶™ê³  hello.htmlì´ ìë™ìœ¼ë¡œ í˜¸ì¶œëœë‹¤.
hello.html ìƒì„±í•˜ëŠ”ë°©ë²•(resources - templatesì— ìƒì„±)

> //build.gradleì—
implementation 'org.springframework.boot:spring-boot-devtools'
ì¶”ê°€í•˜ë©´íŒŒì¼ì„ ì»´íŒŒì¼ë§Œ í•´ì£¼ë©´ ì„œë²„ ì¬ì‹œì‘ ì—†ì´
View íŒŒì¼ ë³€ê²½ì´ ê°€ëŠ¥í•˜ë‹¤.
ì¸í…”ë¦¬J ì»´íŒŒì¼ ë°©ë²•: ë©”ë‰´ build Recompile

# H2-DB ì„¤ì¹˜ ì‹¤í–‰
https://www.h2database.com ë‹¤ìš´ë¡œë“œ ë° ì„¤ì¹˜

ë°ì´í„°ë² ì´ìŠ¤ íŒŒì¼ ìƒì„± ë°©ë²•
h2 console ì‹¤í–‰í›„
JDBC URLì—ë‹¤ê°€ jdbc:h2:~/jpashop (ìµœì†Œ í•œë²ˆ)
~/jpashop.mv.db íŒŒì¼ ìƒì„± í™•ì¸
ì´í›„ ë¶€í„°ëŠ” jdbc:h2:tcp://localhost/~/jpashop ì´ë ‡ê²Œ ì ‘ì†
# jpaì™€ db ì„¤ì •
main/resources/application.yml
```
yml ë„ì–´ì“°ê¸° ì£¼ì˜
spring: #ë„ì–´ì“°ê¸° ì—†ìŒ
 datasource: #ë„ì–´ì“°ê¸° 2ì¹¸
 url: jdbc:h2:tcp://localhost/~/jpashop #4ì¹¸
 username: sa
 password:
 driver-class-name: org.h2.Driver
 jpa: #ë„ì–´ì“°ê¸° 2ì¹¸
 hibernate: #ë„ì–´ì“°ê¸° 4ì¹¸
 ddl-auto: create #ë„ì–´ì“°ê¸° 6ì¹¸
 properties: #ë„ì–´ì“°ê¸° 4ì¹¸
 hibernate: #ë„ì–´ì“°ê¸° 6ì¹¸
# show_sql: true #ë„ì–´ì“°ê¸° 8ì¹¸
 format_sql: true #ë„ì–´ì“°ê¸° 8ì¹¸
logging.level: #ë„ì–´ì“°ê¸° ì—†ìŒ
 org.hibernate.SQL: debug #ë„ì–´ì“°ê¸° 2ì¹¸
# org.hibernate.type: trace #ë„ì–´ì“°ê¸° 2ì¹¸
```
spring.jpa.hibernate.ddl-auto: create
ì´ ì˜µì…˜ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ì‹œì ì— í…Œì´ë¸”ì„ drop í•˜ê³ , ë‹¤ì‹œ ìƒì„±í•œë‹¤.
ì°¸ê³ : ëª¨ë“  ë¡œê·¸ ì¶œë ¥ì€ ê°€ê¸‰ì  ë¡œê±°ë¥¼ í†µí•´ ë‚¨ê²¨ì•¼ í•œë‹¤.
show_sql : ì˜µì…˜ì€ System.out ì— í•˜ì´ë²„ë„¤ì´íŠ¸ ì‹¤í–‰ SQLì„ ë‚¨ê¸´ë‹¤.
org.hibernate.SQL : ì˜µì…˜ì€ loggerë¥¼ í†µí•´ í•˜ì´ë²„ë„¤ì´íŠ¸ ì‹¤í–‰ SQLì„ ë‚¨ê¸´ë‹¤

## jpaê°€ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸
mainì— Memberí´ë˜ìŠ¤ ë§Œë“¤ê³  ì—”í‹°í‹°ìƒì„±
```
@Entity
@Getter @Setter
public class Member {
    @Id @GeneratedValue //@GeneratedValueì´ë€ ìë™ìœ¼ë¡œ idê°’ì´ ì˜¬ë¼ê°€ëŠ”ê²ƒ
    private Long id;
    private String username;
}
```
mainì— Memberì—”í‹°í‹°ë¥¼ ì°¾ì„ìˆ˜ìˆëŠ” repositoryìƒì„±
```

@Repository
public class MemberRepository {
    @PersistenceContext
    EntityManager em;
    public Long save(Member member) {
        em.persist(member);
        return member.getId();
    }
    public Member find(Long id) {
        return em.find(Member.class, id);
    }
}
```

```
@RunWith(SpringRunner.class) //springê³¼ ê´€ë ¨ëœê±°ë¡œ í…ŒìŠ¤íŠ¸í•œë‹¤ ì•Œë¦¬ê¸°
@SpringBootTest
public class MemberRepositoryTest {
    @Autowired MemberRepository memberRepository;
    @Test
    @Transactional
    @Rollback(false) // DBë°ì´í„°ê°€ ì´ˆê¸°í™”ë˜ì§€ ì•ŠìŒ
    public void testMember() { //í…ŒìŠ¤íŠ¸ ì„ì˜í•¨ìˆ˜ë§Œë“¤ê³ 
        Member member = new Member(); //memberê°ì²´ ìƒì„±
        member.setUsername("memberA"); //memberAë¼ëŠ” memberìƒì„±
        Long savedId = memberRepository.save(member); //saveIDë¼ëŠ” ë³€ìˆ˜ì— ì €ì¥
        Member findMember = memberRepository.find(savedId); //findememberë¼ëŠ” ë³€ìˆ˜ì— ì €ì¥
        Assertions.assertThat(findMember.getId()).isEqualTo(member.getId());

        Assertions.assertThat(findMember.getUsername()).isEqualTo(member.getUsername())
        ;
        Assertions.assertThat(findMember).isEqualTo(member); //JPA ì—”í‹°í‹° ë™ì¼ì„± ë³´ì¥ findMember(ì €ì¥í•œê²ƒ)member(ì¡°íšŒí•œê²ƒ)ê°™ì€ì§€ í™•ì¸ ê²°ê³¼ëŠ” true ê°™ì€ íŠ¸ë Œì ì…˜ ì•ˆì—ì„œ ì €ì¥ì„í•˜ê³  ì¡°íšŒë¥¼í•˜ë©´ ì˜ì†ì„±ì»¨í…ìŠ¤íŠ¸ê°€ ë˜‘ê°™ìŒ
    }
}
```


